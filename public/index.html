<!DOCTYPE html>
<html>
<head>
  <title>A/B Testing Interface</title>
  <style>
    /* Add necessary styles */
  </style>
</head>
<body>
  <h1>A/B Testing Interface</h1>
  <form id="urlForm">
    <label for="urlInput">Enter URL:</label>
    <input type="text" id="urlInput" required>
    <button type="submit">Load Screenshot</button>
  </form>
  <div id="screenshotContainer">
    <img id="screenshotImg" src="" alt="Screenshot">
  </div>
  <div id="stylingForm">
    <h2>Styling Options</h2>
    <label for="elementIdInput">Element ID:</label>
    <input type="text" id="elementIdInput" readonly>
    <label for="backgroundColorInput">Background Color:</label>
    <input type="text" id="backgroundColorInput" placeholder="Enter Hex Code">
    <button id="applyStylingBtn">Apply Styling</button>
  </div>

  <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
  <script>
    // Capture the screenshot and enable element selection
    function captureScreenshot() {
      const url = document.getElementById('urlInput').value;
      const screenshotImg = document.getElementById('screenshotImg');

      html2canvas(document.body).then(canvas => {
        const screenshotUrl = canvas.toDataURL('image/png');

        screenshotImg.src = screenshotUrl;

        screenshotImg.addEventListener('click', function (event) {
          const selectedElement = event.target;
          const elementIdInput = document.getElementById('elementIdInput');
          elementIdInput.value = selectedElement.id;
        });
      });
    }

    // Apply styling changes on the live site
    function applyStyling() {
      const elementId = document.getElementById('elementIdInput').value;
      const backgroundColor = document.getElementById('backgroundColorInput').value;

      // Send a request to the backend server to update the element's background color
      fetch('/update-styling', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ elementId, backgroundColor }),
      })
      .then(response => {
        if (response.ok) {
          alert('Styling changes applied successfully!');
        } else {
          alert('Failed to apply styling changes. Please try again.');
        }
      })
      .catch(error => {
        console.error('An error occurred while applying styling changes:', error);
        alert('An error occurred while applying styling changes. Please try again.');
      });
    }

    // Add an event listener to the form submission
    document.getElementById('urlForm').addEventListener('submit', function (event) {
      event.preventDefault();
      captureScreenshot();
    });

    // Add an event listener to the Apply Styling button
    document.getElementById('applyStylingBtn').addEventListener('click', function () {
      applyStyling();
    });
  </script>
</body>
</html>
